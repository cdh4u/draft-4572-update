


Network Working Group                                        C. Holmberg
Internet-Draft                                                  Ericsson
Updates: 4572 (if approved)                                 May 16, 2016
Intended status: Standards Track
Expires: November 17, 2016


                          Updates to RFC 4572
                  draft-ietf-mmusic-4572-update-02.txt

Abstract

   This document defines a new SDP attribute, 'fpl', which can be used
   by SDP offerers and answerers to carry fingerprints associated with a
   certificate.

   This document updates RFC 4572 by clarifying the usage of multiple
   SDP 'fingerprint' attributes with a single TLS connection.  The
   document also updates the preferred cipher suite to be used, and
   removes the requirement to use the same hash function for calculating
   the certificate fingerprint that is used to calculate the certificate
   signature.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on November 17, 2016.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of



Holmberg                Expires November 17, 2016               [Page 1]

Internet-Draft             Updates to RFC 4572                  May 2016


   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  SDP fpl Attribute . . . . . . . . . . . . . . . . . . . . . .   3
     3.1.  General . . . . . . . . . . . . . . . . . . . . . . . . .   3
     3.2.  Syntax  . . . . . . . . . . . . . . . . . . . . . . . . .   4
   4.  SDP Offer/Answer Procedures . . . . . . . . . . . . . . . . .   5
     4.1.  General . . . . . . . . . . . . . . . . . . . . . . . . .   5
     4.2.  Generating the Initial SDP Offer  . . . . . . . . . . . .   5
     4.3.  Generating the Answer . . . . . . . . . . . . . . . . . .   5
     4.4.  Offerer Processing of the SDP Answer  . . . . . . . . . .   6
     4.5.  Modifying the Session . . . . . . . . . . . . . . . . . .   6
   5.  Update to RFC 4572  . . . . . . . . . . . . . . . . . . . . .   6
     5.1.  Update to the sixth paragraph of section 5  . . . . . . .   6
     5.2.  New paragraphs to the end of section 5  . . . . . . . . .   7
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .   8
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   8
   8.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   8
   9.  Change Log  . . . . . . . . . . . . . . . . . . . . . . . . .   8
   10. References  . . . . . . . . . . . . . . . . . . . . . . . . .   9
     10.1.  Normative References . . . . . . . . . . . . . . . . . .   9
     10.2.  Informative References . . . . . . . . . . . . . . . . .  10
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  10

1.  Introduction

   RFC 4572 [RFC4572] specifies how to establish Transport Layer
   Security (TLS) connections using the Session Description Protocol
   (SDP) [RFC4566].

   RFC 4572 defines the SDP 'fingerprint' attribute, which is used to
   carry a secure hash value (fingerprint) associated with a
   certificate.  However, RFC 4572 is currently unclear on whether
   multiple 'fingerprint' attributes can be associated with a single SDP
   media description ("m= line") [RFC4566], and the associated
   semantics.  Multiple fingerprints are needed if an endpoints wants to
   provide multiple fingerprints associated with a single certificate,
   or if an endpoints wants to provide fingerprints associated with
   multiple certificate.  For example, with RTP-based media, an endpoint
   might use different certificates for RTP and RTCP.



Holmberg                Expires November 17, 2016               [Page 2]

Internet-Draft             Updates to RFC 4572                  May 2016


   RFC 4572 also specifies a preferred cipher suite.  However, the
   currently preferred cipher suite is considered outdated, and the
   preference needs to be updated.

   RFC 4572 mandates that the hash function used to calculate the
   fingerprint is the same hash function used to calculate the
   certificate signature.  That requirement might prevent usage of
   newer, stronger and more collision-safe hash functions for
   calculating certificate fingerprints.  This change also requires that
   multiple 'fingerprint' attributes can be associated with a single
   "m=" line, so that implementations are able to provide hashes
   generated with updated hash functions alongside those that are needed
   to interoperate with existing implementations.

   This document updates RFC 4572 [RFC4572] by clarifying the usage of
   multiple SDP 'fingerprint' attributes.  It is clarified that multiple
   'fingerprint' attributes can be used to carry fingerprints,
   calculated using different hash functions, associated with a given
   certificate, but the attribute cannot be used to carry fingerprints
   associated with multiple certificates.

   This document also defines a new SDP attribute, 'fpl', which can be
   used to carry multiple fingerprints associated with a single
   certificate.

2.  Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

3.  SDP fpl Attribute

3.1.  General

   The SDP 'fpl' (abbreviation of FingerPrint List) attribute is used to
   carry one or many fingerprints associated with a certificate.  Any
   given attribute instance can only be associated with a single
   certificate.  Multiple 'fpl' attributes can be associated with a
   given SDP media description ("m=" line) in order to carry
   fingerprints associated with multiple certificates.

   NOTE: The difference between the SDP 'fpl' attribute and the SDP
   'fingerprint' attribute [RFC4572]and the SDP 'fpl' is that the 'fpl'
   attribute can be used to associate multiple fingerprints (calculated
   using different hash functions) with a certificate.  The
   'fingerprint' attribute can only be used to carry a single
   fingerprint.



Holmberg                Expires November 17, 2016               [Page 3]

Internet-Draft             Updates to RFC 4572                  May 2016


   When an endpoint matches

3.2.  Syntax


     attribute              =/ fingerprint-list

     fingerprint-list       =  "fpl" ":" hash-func SP fingerprint
                                         *(":" hash-func SP fingerprint)

     ;hash-func is defined in RFC 4572
     ;fingerprint is defined in RFC 4572

     Example:

     a=fpl:SHA-1 \
           4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB \
           SHA-256 \
           4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB



   There is no default value defined for the SDP 'fpl' attribute.
   Implementations that wish to use the attribute MUST explicitly
   include it in SDP offers and answers.

   The 'fpl' attribute may be either a session-level or a media- level
   SDP attribute.  If it is a session-level attribute, it applies to all
   SDP media descriptions ("m=" lines) with which no media-level 'fpl'
   attribute has been associated.

   The mux category [I-D.ietf-mmusic-sdp-mux-attributes] for the 'fpl'
   attribute is 'IDENTICAL', which means that the attribute value must
   be identical across all media descriptions being multiplexed
   [I-D.ietf-mmusic-sdp-bundle-negotiation].

   For SDP media descriptions ("m=" lines) describing RTP-based media,
   the 'fpl' attribute applies to the whole media description.  The
   attribute MUST NOT be defined per source (using the SDP 'ssrc'
   attribute [RFC5576]).

   The SDP Offer/Answer [RFC3264] procedures associated with the
   attribute are defined in Section 4








Holmberg                Expires November 17, 2016               [Page 4]

Internet-Draft             Updates to RFC 4572                  May 2016


4.  SDP Offer/Answer Procedures

4.1.  General

   This section defines the SDP Offer/Answer procedures for the SDP
   'fpl' attribute.  The procedures are defined for any SDP media
   description ("m=" line) describing TLS/DTLS protected media.

4.2.  Generating the Initial SDP Offer

   When the offerer sends the initial offer, it MUST associate one or
   more SDP 'fpl' attributes with an SDP media description ("m=" line)
   describing TLS/DTLS protected media.  Each attribute contains one or
   more fingerprint values calculated for a given certificate.

   In addition, the offerer MAY associate one or more SDP 'fingerprint'
   attributes with the "m=" line, according to the procedures in
   [RFC4572].

   If the offerer associates both 'fpl' attributes and 'fingerprint'
   attributes with the "m=" line in the offer, the fingerprint value
   included in any 'fingerprint' attribute MUST also be included in the
   'fpl' attribute associated with the same certificate.

4.3.  Generating the Answer

   When an answerer receives an offer that contains one or more SDP
   'fpl' attributes, and if the answerer accepts the "m=" line, the
   answerer MUST associate one or more 'fpl' attributes with the
   corresponding "m=" line in the answer.

   If the offer does not contain any 'fpl' attribute, the answerer
   SHOULD NOT associate any 'fpl' attribute with the corresponding "m="
   line in the answer.

   If the offer contains one or more SDP 'fingerprint' attributes, the
   answerer follows the procedures in [RFC4572] for generating the
   answer.

   If the answerer associates both 'fpl' attributes and 'fingerprint'
   attributes with the "m=" line in the answer, the fingerprint value
   included in any 'fingerprint' attribute MUST also be included in the
   'fpl' attribute associated with the same certificate.








Holmberg                Expires November 17, 2016               [Page 5]

Internet-Draft             Updates to RFC 4572                  May 2016


4.4.  Offerer Processing of the SDP Answer

   TBD

4.5.  Modifying the Session

   When an offerer sends a subsequent offer, and the offerer does not
   explicitly requests a new TLS connection/DTLS association to be
   established, the offerer MUST associate SDP 'fpl' attribute(s) that
   include the hash values associated with the previously negotiated TLS
   connection/DTLS association.  The offerer MUST NOT associate SDP
   'fpl' attributes including fingerprints for non-uses certificates.

   When an offerer sends a subsequent offer, if the offerer explicitly
   requests a new TLS connection/DTLS association to be established, the
   offerer follow the procedures in Section 4.2.

   [RFC4572] describes the procedures for negotiating a new TLS
   connection.

   [ref-to-draft-dtls-sdp] describes the procedures for negotiating a
   new DTLS association.

5.  Update to RFC 4572

   This section updates section 5 of RFC 4572.

5.1.  Update to the sixth paragraph of section 5























Holmberg                Expires November 17, 2016               [Page 6]

Internet-Draft             Updates to RFC 4572                  May 2016


 OLD TEXT:

    A certificate fingerprint MUST be computed using the same one-way
    hash function as is used in the certificate's signature algorithm.
    (This ensures that the security properties required for the
    certificate also apply for the fingerprint.  It also guarantees that
    the fingerprint will be usable by the other endpoint, so long as the
    certificate itself is.)  Following RFC 3279 [7] as updated by RFC
    4055 [9], therefore, the defined hash functions are 'SHA-1' [11]
    [19], 'SHA-224' [11], 'SHA-256' [11], 'SHA-384' [11], 'SHA-512' [11]
    , 'MD5' [12], and 'MD2' [13], with 'SHA-1' preferred.  A new IANA
    registry of Hash Function Textual Names, specified in Section 8,
    allows for addition of future tokens, but they may only be added if
    they are included in RFCs that update or obsolete RFC 3279 [7].
    Self-signed certificates (for which legacy certificates are not a
    consideration) MUST use one of the FIPS 180 algorithms (SHA-1,
    SHA-224, SHA-256, SHA-384, or SHA-512) as their signature algorithm,
    and thus also MUST use it to calculate certificate fingerprints.


 NEW TEXT:

    Following RFC 3279 [7] as updated by RFC 4055 [9], therefore, the
    defined hash functions are 'SHA-1' [11] [19], 'SHA-224' [11],
    'SHA-256' [11], 'SHA-384' [11], 'SHA-512' [11], 'MD5' [12], and
    'MD2' [13], with 'SHA-256' preferred.  A new IANA registry of Hash
    Function Textual Names, specified in Section 8, allows for addition
    of future tokens, but they may only be added if they are included
    in RFCs that update or obsolete RFC 3279 [7].


5.2.  New paragraphs to the end of section 5



















Holmberg                Expires November 17, 2016               [Page 7]

Internet-Draft             Updates to RFC 4572                  May 2016


NEW TEXT:

    Multiple SDP fingerprint attributes can be associatd with an m-
    line, in order to carry fingerprints calculated using
    different hash functions for a given cerfificiate. All fingerprints
    carried in SDP fingerprint attributes, associated with a given m- line,
    MUST be associated with the same certificate.

    In some cases endpoints want to provide fingerprints
    associated with multiple cerficiates (e.g. if separate certificates
    are used for RTP and RTCP). In such cases, endpoints MUST use the
    mechanism in <ref-to-this-draft> in order to provide them
    to the peer.

    An endpoint MUST be able to match at least one of the received
    fingerprints with the used cerficiate. If there is no match,
    the endpoint MUST NOT establish the TLS connection.

    NOTE: The SDP fingerprint attribute does not contain a reference to
    a specific certificate. Endpoints need to compare the fingerprint
    with a certificate hash in order to look for a match.


6.  Security Considerations

   This document improves security.  It updates the preferred hash
   function cipher suite from SHA-1 to SHA-256.  By clarifying the usage
   and handling of multiple fingerprints, the document also enables hash
   agility, and incremental deployment of newer, and more secure, cipher
   suites.

7.  IANA Considerations

   This document makes no requests from IANA.

8.  Acknowledgements

   Martin Thomson, Paul Kyzivat, Jonathan Lennox and Roman Shpount
   provided valuable comments and input on this document.

9.  Change Log

   [RFC EDITOR NOTE: Please remove this section when publishing]

   Changes from draft-ietf-mmusic-4572-update-01

   o  Changes based on comments from Martin Thomson.




Holmberg                Expires November 17, 2016               [Page 8]

Internet-Draft             Updates to RFC 4572                  May 2016


   o  - Editorial fixes

   o  New SDP 'fpl' attribuge added.

   o

   Changes from draft-ietf-mmusic-4572-update-00

   o  Changes in handling of multiple fingerprints.

   o  - Number of fingerprints calculated for each certificate does not
      have to match.

   o  - Clarified that receiver shall check check fingerprints using
      hash algorithms it considers safe.

   o  - Additional text added to security considerations section.

   Changes from draft-holmberg-mmusic-4572-update-01

   o  Adopted WG document (draft-ietf-mmusic-4572-update-00) submitted.

   o  IANA considerations section added.

10.  References

10.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC3264]  Rosenberg, J. and H. Schulzrinne, "An Offer/Answer Model
              with Session Description Protocol (SDP)", RFC 3264,
              DOI 10.17487/RFC3264, June 2002,
              <http://www.rfc-editor.org/info/rfc3264>.

   [RFC4572]  Lennox, J., "Connection-Oriented Media Transport over the
              Transport Layer Security (TLS) Protocol in the Session
              Description Protocol (SDP)", RFC 4572,
              DOI 10.17487/RFC4572, July 2006,
              <http://www.rfc-editor.org/info/rfc4572>.

   [RFC4566]  Handley, M., Jacobson, V., and C. Perkins, "SDP: Session
              Description Protocol", RFC 4566, DOI 10.17487/RFC4566,
              July 2006, <http://www.rfc-editor.org/info/rfc4566>.




Holmberg                Expires November 17, 2016               [Page 9]

Internet-Draft             Updates to RFC 4572                  May 2016


10.2.  Informative References

   [RFC5576]  Lennox, J., Ott, J., and T. Schierl, "Source-Specific
              Media Attributes in the Session Description Protocol
              (SDP)", RFC 5576, DOI 10.17487/RFC5576, June 2009,
              <http://www.rfc-editor.org/info/rfc5576>.

   [I-D.ietf-mmusic-sdp-mux-attributes]
              Nandakumar, S., "A Framework for SDP Attributes when
              Multiplexing", draft-ietf-mmusic-sdp-mux-attributes-12
              (work in progress), January 2016.

   [I-D.ietf-mmusic-sdp-bundle-negotiation]
              Holmberg, C., Alvestrand, H., and C. Jennings,
              "Negotiating Media Multiplexing Using the Session
              Description Protocol (SDP)", draft-ietf-mmusic-sdp-bundle-
              negotiation-29 (work in progress), April 2016.

Author's Address

   Christer Holmberg
   Ericsson
   Hirsalantie 11
   Jorvas  02420
   Finland

   Email: christer.holmberg@ericsson.com
























Holmberg                Expires November 17, 2016              [Page 10]
